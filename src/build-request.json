{
  "kind": "build_request",
  "title": "Add user removal functionality to user management",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Add a backend method in the main actor to allow primary admins to permanently remove user accounts from the system by principal ID",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-user-remove-request"
        ]
      },
      "acceptanceCriteria": [
        "Method validates that the caller is a primary admin before allowing removal",
        "Method accepts a principal ID and removes the corresponding user profile from state",
        "Method returns success confirmation or appropriate error messages",
        "Removed users cannot access the system after deletion"
      ]
    },
    {
      "id": "REQ-2",
      "text": "Add a 'Remove User' button to each user row in the UserManagementModule table that triggers a confirmation dialog before deletion",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-remove-request"
        ]
      },
      "acceptanceCriteria": [
        "Remove button appears for each user in the management table",
        "Button is styled with destructive/warning styling to indicate permanent action",
        "Clicking the button opens a confirmation dialog explaining the action is irreversible",
        "Confirmation dialog displays the user's name and email for verification",
        "Only primary admins can see and use the remove button"
      ]
    },
    {
      "id": "REQ-3",
      "text": "Create a React Query mutation hook for removing users that calls the backend removal method and invalidates relevant queries on success",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-remove-request"
        ]
      },
      "acceptanceCriteria": [
        "Mutation hook handles loading, success, and error states",
        "On successful removal, the user list query is invalidated and refetched",
        "Success toast notification confirms user removal",
        "Error toast displays if removal fails with appropriate error message"
      ]
    },
    {
      "id": "REQ-4",
      "text": "Prevent users from removing themselves to avoid accidentally locking themselves out of the admin panel",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-user-remove-request"
        ]
      },
      "acceptanceCriteria": [
        "Backend method rejects removal requests where the caller's principal matches the target user",
        "Frontend hides or disables the remove button for the current user's own account",
        "Attempting self-removal shows an error message explaining the restriction"
      ]
    }
  ],
  "constraints": [
    "Only primary admins can remove users (secondary admins must not have access)",
    "User removal must be a permanent, irreversible action",
    "The current logged-in admin cannot remove their own account"
  ],
  "nonGoals": [
    "Soft deletion or archiving of users (removal should be permanent)",
    "Bulk user removal functionality",
    "User suspension or temporary account deactivation",
    "Restoring or recovering removed users"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}